<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Clustering through the epigraph and hypograph indices • ehymet</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Clustering through the epigraph and hypograph indices">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ehymet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/ehymet-01-introduction.html">Introduction to ehymet</a></li>
    <li><a class="dropdown-item" href="../articles/ehymet-02-clustering-epi-hypo.html">Clustering through the epigraph and hypograph indices</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bpulidob/ehymet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Clustering through the epigraph and hypograph indices</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bpulidob/ehymet/blob/main/vignettes/ehymet-02-clustering-epi-hypo.Rmd" class="external-link"><code>vignettes/ehymet-02-clustering-epi-hypo.Rmd</code></a></small>
      <div class="d-none name"><code>ehymet-02-clustering-epi-hypo.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bpulidob/ehymet" class="external-link">ehymet</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="the-ehyclus-function">The EHyClus function<a class="anchor" aria-label="anchor" href="#the-ehyclus-function"></a>
</h2>
<p>One of the main utilities of the epigraph and the hypograph index is
to be able to measure ``extremality’’ of a curve with respect to a bunch
of curves and to provide and ordination of the curves from top to bottom
or vice-versa.</p>
<p>EHyClus is a methodology for clustering functional data which is
based in four steps:</p>
<ol style="list-style-type: decimal">
<li>Smooth the functional dataset.</li>
<li>Apply the indices to data, first and second derivatives.</li>
<li>Apply classical multivariate clustering technique.</li>
<li>Obtain a clustering partition in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
groups
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
fixed in advanced).</li>
</ol>
<p>In <code>ehymet</code>, the function that allows us to perform this
process is <code>EHyClus</code>.</p>
<p>EHyClus function is designed for clustering functional datasets. The
input data can be a one-dimensional dataset,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">n \times p</annotation></semantics></math>
matrix, or a multidimensional one,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>p</mi><mo>×</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">n \times p \times q</annotation></semantics></math>
array. The function transforms the initial dataset by first smoothing
the data and then applying different indices analyzed on the first
vignette such as the epigraph, hypograph, and their modified versions,
and then applies various clustering algorithms to this dataset. Indices
for one or multiple dimension are applied depending on the size of the
input data.</p>
<p>It supports multiple clustering methods: <strong>hierarchical
clustering</strong> (“hierarch”), <strong>k-means</strong> (“kmeans”),
<strong>kernel k-means</strong> (“kkmeans”), and <strong>spectral
clustering</strong> (“spc”). Also, it allows customization of
hierarchical clustering methods, distance metrics, and kernels using
parameters like <code>l_dist_hierarch</code>.</p>
<p>For smoothing, it uses B-splines with a specified or automatically
selected number of basis functions.</p>
<p>To check the quality of the results, if true labels are provided, the
function can validate the clustering results and compute performance
metrics such as purity, F-measure, and Rand Index (RI). Also, it records
the time taken for each clustering method, in case you want to measure
it in case of wanting to know the trade-off between results and
execution time</p>
<div class="section level3">
<h3 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h3>
<p>All the parameters and its functionality can be found on the function
documentation, but arguably the most important ones are:</p>
<ul>
<li>
<strong>curves</strong>: The dataset containing the curves to be
clustered.</li>
<li>
<strong>vars_combinations</strong>: This parameter can be provided
or not. In case it is provided, it can be a list that determines the
combination of variables to use or “auto”, where a one combination of
data and indices is set trying to optimize the results. If not provided,
a default list with generic combinations of variables is used.</li>
<li>
<strong>clustering_methods</strong>: A vector specifying which
clustering methods to apply.</li>
<li>
<strong>n_clusters</strong> Number of clusters to generate.</li>
<li>
<strong>k</strong>: Number of basis functions for B-splines. Not to
be confused with <strong>n_clusters</strong>.</li>
<li>
<strong>bs</strong>: Type of penalized smoothing basis to use.</li>
<li>
<strong>true_labels</strong>: If provided, evaluation metrics are
provided along the result.</li>
</ul>
</div>
<div class="section level3">
<h3 id="example-of-usage-and-validation">Example of usage and validation<a class="anchor" aria-label="anchor" href="#example-of-usage-and-validation"></a>
</h3>
<p>In this subsection, we are going to display how to obtain the results
of the <code>EHyClus</code> function and validate them (if
<code>true_labels</code> are present). First, we are going to generate
multidimensional data using <code>sim_model_ex2</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">curves</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_model_ex2.html">sim_model_ex2</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, i_sim <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>And, as we are generating
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">n = 50</annotation></semantics></math>
curves per group and there are two groups, the true labels are:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">true_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can run the algorithm with or without the true labels. For the
combinations of variables, we will use “d2dtaMEI” with “d2dtaMHI”.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/EHyClus.html">EHyClus</a></span><span class="op">(</span><span class="va">curves</span>, vars_combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d2dtaMEI"</span>, <span class="st">"d2dtaMHI"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res_with_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/EHyClus.html">EHyClus</a></span><span class="op">(</span><span class="va">curves</span>,</span>
<span>  vars_combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d2dtaMEI"</span>, <span class="st">"d2dtaMHI"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  true_labels <span class="op">=</span> <span class="va">true_labels</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>For the result without labels, it can be seen that we only have the
generated clusters:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "cluster"</span></span></code></pre></div>
<p>Whereas the one we generated with labels has both
<code>cluster</code> and <code>metrics</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res_with_labels</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "cluster" "metrics"</span></span></code></pre></div>
<p>Let’s explore both components of the latter. We’re going to start
with <code>cluster</code>.</p>
<pre><code><span><span class="co">#&gt;                                               levelName</span></span>
<span><span class="co">#&gt; 1  cluster                                             </span></span>
<span><span class="co">#&gt; 2   ¦--hierarch                                        </span></span>
<span><span class="co">#&gt; 3   ¦   ¦--hierarch_single_euclidean_d2dtaMEId2dtaMHI  </span></span>
<span><span class="co">#&gt; 4   ¦   ¦   ¦--valid                                   </span></span>
<span><span class="co">#&gt; 5   ¦   ¦   °--internal_metrics                        </span></span>
<span><span class="co">#&gt; 6   ¦   ¦--hierarch_complete_euclidean_d2dtaMEId2dtaMHI</span></span>
<span><span class="co">#&gt; 7   ¦   ¦   ¦--valid                                   </span></span>
<span><span class="co">#&gt; 8   ¦   ¦   °--internal_metrics                        </span></span>
<span><span class="co">#&gt; 9   ¦   ¦--hierarch_average_euclidean_d2dtaMEId2dtaMHI </span></span>
<span><span class="co">#&gt; 10  ¦   ¦   ¦--valid                                   </span></span>
<span><span class="co">#&gt; 11  ¦   ¦   °--internal_metrics                        </span></span>
<span><span class="co">#&gt; 12  ¦   ¦--hierarch_centroid_euclidean_d2dtaMEId2dtaMHI</span></span>
<span><span class="co">#&gt; 13  ¦   ¦   ¦--valid                                   </span></span>
<span><span class="co">#&gt; 14  ¦   ¦   °--internal_metrics                        </span></span>
<span><span class="co">#&gt; 15  ¦   ¦--hierarch_ward.D2_euclidean_d2dtaMEId2dtaMHI </span></span>
<span><span class="co">#&gt; 16  ¦   ¦   ¦--valid                                   </span></span>
<span><span class="co">#&gt; 17  ¦   ¦   °--internal_metrics                        </span></span>
<span><span class="co">#&gt; 18  ¦   ¦--hierarch_single_manhattan_d2dtaMEId2dtaMHI  </span></span>
<span><span class="co">#&gt; 19  ¦   ¦   ¦--valid                                   </span></span>
<span><span class="co">#&gt; 20  ¦   ¦   °--internal_metrics                        </span></span>
<span><span class="co">#&gt; 21  ¦   ¦--hierarch_complete_manhattan_d2dtaMEId2dtaMHI</span></span>
<span><span class="co">#&gt; 22  ¦   ¦   ¦--valid                                   </span></span>
<span><span class="co">#&gt; 23  ¦   ¦   °--internal_metrics                        </span></span>
<span><span class="co">#&gt; 24  ¦   ¦--hierarch_average_manhattan_d2dtaMEId2dtaMHI </span></span>
<span><span class="co">#&gt; 25  ¦   ¦   ¦--valid                                   </span></span>
<span><span class="co">#&gt; 26  ¦   ¦   °--internal_metrics                        </span></span>
<span><span class="co">#&gt; 27  ¦   ¦--hierarch_centroid_manhattan_d2dtaMEId2dtaMHI</span></span>
<span><span class="co">#&gt; 28  ¦   ¦   ¦--valid                                   </span></span>
<span><span class="co">#&gt; 29  ¦   ¦   °--internal_metrics                        </span></span>
<span><span class="co">#&gt; 30  ¦   °--hierarch_ward.D2_manhattan_d2dtaMEId2dtaMHI </span></span>
<span><span class="co">#&gt; 31  ¦       ¦--valid                                   </span></span>
<span><span class="co">#&gt; 32  ¦       °--internal_metrics                        </span></span>
<span><span class="co">#&gt; 33  ¦--kmeans                                          </span></span>
<span><span class="co">#&gt; 34  ¦   ¦--kmeans_euclidean_d2dtaMEId2dtaMHI           </span></span>
<span><span class="co">#&gt; 35  ¦   ¦   ¦--valid                                   </span></span>
<span><span class="co">#&gt; 36  ¦   ¦   °--internal_metrics                        </span></span>
<span><span class="co">#&gt; 37  ¦   °--kmeans_mahalanobis_d2dtaMEId2dtaMHI         </span></span>
<span><span class="co">#&gt; 38  ¦       ¦--valid                                   </span></span>
<span><span class="co">#&gt; 39  ¦       °--internal_metrics                        </span></span>
<span><span class="co">#&gt; 40  ¦--kkmeans                                         </span></span>
<span><span class="co">#&gt; 41  ¦   ¦--kkmeans_rbfdot_d2dtaMEId2dtaMHI             </span></span>
<span><span class="co">#&gt; 42  ¦   ¦   ¦--valid                                   </span></span>
<span><span class="co">#&gt; 43  ¦   ¦   °--internal_metrics                        </span></span>
<span><span class="co">#&gt; 44  ¦   °--kkmeans_polydot_d2dtaMEId2dtaMHI            </span></span>
<span><span class="co">#&gt; 45  ¦       ¦--valid                                   </span></span>
<span><span class="co">#&gt; 46  ¦       °--internal_metrics                        </span></span>
<span><span class="co">#&gt; 47  °--spc                                             </span></span>
<span><span class="co">#&gt; 48      ¦--spc_rbfdot_d2dtaMEId2dtaMHI                 </span></span>
<span><span class="co">#&gt; 49      ¦   ¦--valid                                   </span></span>
<span><span class="co">#&gt; 50      ¦   °--internal_metrics                        </span></span>
<span><span class="co">#&gt; 51      °--spc_polydot_d2dtaMEId2dtaMHI                </span></span>
<span><span class="co">#&gt; 52          ¦--valid                                   </span></span>
<span><span class="co">#&gt; 53          °--internal_metrics</span></span></code></pre>
<p>In the suffix of the names we can see the combination of variables
used, that is “d2dtaMEI” with “d2dtaMHI”. We can also see the different
parameters used. For example, for the kmeans it is easy to see that it
has been performed with both the Euclidean and the Mahalanobis
distances.</p>
<p>Looking in particular at some of the elements, we see that it
contains the following:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">res_with_labels</span><span class="op">$</span><span class="va">cluster</span><span class="op">$</span><span class="va">hierarch</span><span class="op">$</span><span class="va">hierarch_ward.D2_euclidean_d2dtaMEId2dtaMHI</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 4</span></span>
<span><span class="co">#&gt;  $ cluster         : int [1:100] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ valid           :List of 4</span></span>
<span><span class="co">#&gt;   ..$ Purity  : num 0.93</span></span>
<span><span class="co">#&gt;   ..$ Fmeasure: num 0.868</span></span>
<span><span class="co">#&gt;   ..$ RI      : num 0.869</span></span>
<span><span class="co">#&gt;   ..$ ARI     : num 0.737</span></span>
<span><span class="co">#&gt;  $ internal_metrics:List of 4</span></span>
<span><span class="co">#&gt;   ..$ davies_bouldin: num 1.01</span></span>
<span><span class="co">#&gt;   ..$ dunn          : num 0.06</span></span>
<span><span class="co">#&gt;   ..$ silhouette    : num 0.409</span></span>
<span><span class="co">#&gt;   ..$ infomax       : num 0.993</span></span>
<span><span class="co">#&gt;  $ time            : num 0.000373</span></span></code></pre></div>
<p>On the one hand we have <code>cluster</code> which is the vector that
assigns each of the curves to a cluster. Then we have
<code>valid</code>, which is the validation data. And finally
<code>time</code>, which is the time that this particular method has
taken to be executed. Let’s take a look at <code>valid</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res_with_labels</span><span class="op">$</span><span class="va">cluster</span><span class="op">$</span><span class="va">hierarch</span><span class="op">$</span><span class="va">hierarch_ward.D2_euclidean_d2dtaMEId2dtaMHI</span><span class="op">$</span><span class="va">valid</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Purity</span></span>
<span><span class="co">#&gt; [1] 0.93</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Fmeasure</span></span>
<span><span class="co">#&gt; [1] 0.8678</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $RI</span></span>
<span><span class="co">#&gt; [1] 0.8685</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ARI</span></span>
<span><span class="co">#&gt; [1] 0.737</span></span></code></pre></div>
<p>It gives us 3 metrics: Purity, F-measure and the Rand Index (RI).
However, we can obtain this information in another way. Going back to
the second element of <code>res_with_labels</code>: <code>metrics</code>
give us a summary of all metrics:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res_with_labels</span><span class="op">$</span><span class="va">metrics</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                             Purity Fmeasure     RI   ARI         Time</span></span>
<span><span class="co">#&gt; kmeans_euclidean_d2dtaMEId2dtaMHI             1.00   1.0000 1.0000 1.000 0.0032920837</span></span>
<span><span class="co">#&gt; kmeans_mahalanobis_d2dtaMEId2dtaMHI           1.00   1.0000 1.0000 1.000 0.0038609505</span></span>
<span><span class="co">#&gt; hierarch_ward.D2_euclidean_d2dtaMEId2dtaMHI   0.93   0.8678 0.8685 0.737 0.0003728867</span></span></code></pre></div>
<p>It gives us the Purity, F-measure, RI and Time for every clustering
method with every combination of parameters that has been executed. We
can search for “hierarch_single_euclidean_d2dtaMEId2dtaMHI” and see that
it yields the same results as seen previously:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_with_labels</span><span class="op">$</span><span class="va">metrics</span><span class="op">[</span><span class="st">"hierarch_single_euclidean_d2dtaMEId2dtaMHI"</span>, <span class="op">]</span></span>
<span><span class="co">#&gt;                                            Purity Fmeasure     RI   ARI         Time</span></span>
<span><span class="co">#&gt; hierarch_single_euclidean_d2dtaMEId2dtaMHI   0.52   0.6535 0.4958 8e-04 0.0004339218</span></span></code></pre></div>
<p>But now imagine that we executed <code>EHyClus</code> without giving
the <code>true_labels</code> parameter but we want to compute the
metrics. For that purpose, we can use the
<code>clustering_validation</code> function, using the true labels as
the first parameter and the ones generated by the clustering method as
the second one:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/clustering_validation.html">clustering_validation</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">cluster</span><span class="op">$</span><span class="va">hierarch</span><span class="op">$</span><span class="va">hierarch_single_euclidean_d2dtaMEId2dtaMHI</span><span class="op">$</span><span class="va">cluster</span>, <span class="va">true_labels</span><span class="op">)</span></span>
<span><span class="co">#&gt; $Purity</span></span>
<span><span class="co">#&gt; [1] 0.52</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Fmeasure</span></span>
<span><span class="co">#&gt; [1] 0.6535</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $RI</span></span>
<span><span class="co">#&gt; [1] 0.4958</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $ARI</span></span>
<span><span class="co">#&gt; [1] 8e-04</span></span></code></pre></div>
<p>Note that we are only taking a look at some of the result. Let’s see
if some of them have given us better metrics. Results are sorted based
on the RI:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res_with_labels</span><span class="op">$</span><span class="va">metrics</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                             Purity Fmeasure     RI    ARI         Time</span></span>
<span><span class="co">#&gt; kmeans_euclidean_d2dtaMEId2dtaMHI             1.00   1.0000 1.0000 1.0000 0.0032920837</span></span>
<span><span class="co">#&gt; kmeans_mahalanobis_d2dtaMEId2dtaMHI           1.00   1.0000 1.0000 1.0000 0.0038609505</span></span>
<span><span class="co">#&gt; hierarch_ward.D2_euclidean_d2dtaMEId2dtaMHI   0.93   0.8678 0.8685 0.7370 0.0003728867</span></span>
<span><span class="co">#&gt; hierarch_ward.D2_manhattan_d2dtaMEId2dtaMHI   0.93   0.8685 0.8685 0.7370 0.0005681515</span></span>
<span><span class="co">#&gt; kkmeans_rbfdot_d2dtaMEId2dtaMHI               0.77   0.6684 0.6422 0.2857 0.0494818687</span></span></code></pre></div>
<p>Indeed, we can see that some methods have given us excellent results,
performing an almost perfect clustering.</p>
<p>In addition, if we only want to obtain the results for the best
clustering method, we can use the <code>only_best</code> parameter. Note
that this parameter only works when <code>true_labels</code> is
provided.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_only_best</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/EHyClus.html">EHyClus</a></span><span class="op">(</span><span class="va">curves</span>,</span>
<span>  vars_combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"d2dtaMEI"</span>, <span class="st">"d2dtaMHI"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  true_labels <span class="op">=</span> <span class="va">true_labels</span>,</span>
<span>  only_best <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>If we inspect the object, we see that in fact it only contains the
results of the clustering method that has obtained the best results.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_only_best</span><span class="op">$</span><span class="va">cluster</span></span>
<span><span class="co">#&gt; $kmeans_euclidean_d2dtaMEId2dtaMHI</span></span>
<span><span class="co">#&gt; $kmeans_euclidean_d2dtaMEId2dtaMHI$cluster</span></span>
<span><span class="co">#&gt;   [1] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 1 1 1 1</span></span>
<span><span class="co">#&gt;  [55] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kmeans_euclidean_d2dtaMEId2dtaMHI$valid</span></span>
<span><span class="co">#&gt; $kmeans_euclidean_d2dtaMEId2dtaMHI$valid$Purity</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kmeans_euclidean_d2dtaMEId2dtaMHI$valid$Fmeasure</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kmeans_euclidean_d2dtaMEId2dtaMHI$valid$RI</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kmeans_euclidean_d2dtaMEId2dtaMHI$valid$ARI</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kmeans_euclidean_d2dtaMEId2dtaMHI$internal_metrics</span></span>
<span><span class="co">#&gt; $kmeans_euclidean_d2dtaMEId2dtaMHI$internal_metrics$davies_bouldin</span></span>
<span><span class="co">#&gt; [1] 0.9024109</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kmeans_euclidean_d2dtaMEId2dtaMHI$internal_metrics$dunn</span></span>
<span><span class="co">#&gt; [1] 0.07203434</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kmeans_euclidean_d2dtaMEId2dtaMHI$internal_metrics$silhouette</span></span>
<span><span class="co">#&gt; [1] 0.4593925</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kmeans_euclidean_d2dtaMEId2dtaMHI$internal_metrics$infomax</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $kmeans_euclidean_d2dtaMEId2dtaMHI$time</span></span>
<span><span class="co">#&gt; [1] 0.004937172</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_only_best</span><span class="op">$</span><span class="va">metrics</span></span>
<span><span class="co">#&gt;                                   Purity Fmeasure RI ARI        Time</span></span>
<span><span class="co">#&gt; kmeans_euclidean_d2dtaMEId2dtaMHI      1        1  1   1 0.004937172</span></span></code></pre></div>
<p>This can be useful if you want to use the function as if it were a
typical clustering method.</p>
</div>
<div class="section level3">
<h3 id="automatic-variable-selection">Automatic variable selection<a class="anchor" aria-label="anchor" href="#automatic-variable-selection"></a>
</h3>
<p>When <code>vars_combinations = "auto"</code>, <code>EHyClus</code>
will automatically select an optimal combination of variables through a
data-driven approach. This process works is comprised of two main
steps:</p>
<p>The first step focuses on identifying variables that show enough
variation to be meaningful discriminators. For each variable, the
function calculates how many unique values it contains relative to its
total number of observations. Only variables where this ratio exceeds
50% are retained. This ensures that we focus on variables that have
sufficient variation to be useful in distinguishing between different
groups.</p>
<p>The second step deals with redundancy in our selected variables.
After all, having multiple variables that essentially contain the same
information won’t improve our clustering results. To address this, the
function examines how correlated our remaining variables are with each
other. If two variables show a correlation higher than 0.75, we keep
only one of them. Specifically, we look at how correlated each variable
is with all other variables on average, and remove the one that shows
higher average correlation. This helps ensure our final set of variables
provides unique, non-redundant information for clustering.</p>
<p>Here’s an example using automatic variable selection:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate sample data</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">curves</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_model_ex2.html">sim_model_ex2</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, i_sim <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">true_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Use automatic variable selection</span></span>
<span><span class="va">res_auto</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/EHyClus.html">EHyClus</a></span><span class="op">(</span><span class="va">curves</span>, </span>
<span>                    vars_combinations <span class="op">=</span> <span class="st">"auto"</span>,</span>
<span>                    true_labels <span class="op">=</span> <span class="va">true_labels</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Look at which variables were selected</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">res_auto</span>, <span class="st">"vars_combinations"</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "ddtaMEI"  "dtaMHI"   "ddtaMHI"  "d2dtaMHI"</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Belen Pulido.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
