<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to ehymet ‚Ä¢ ehymet</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to ehymet">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ehymet</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/ehymet-01-introduction.html">Introduction to ehymet</a></li>
    <li><a class="dropdown-item" href="../articles/ehymet-02-clustering-epi-hypo.html">Clustering through the epigraph and hypograph indices</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bpulidob/ehymet/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to ehymet</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bpulidob/ehymet/blob/main/vignettes/ehymet-01-introduction.Rmd" class="external-link"><code>vignettes/ehymet-01-introduction.Rmd</code></a></small>
      <div class="d-none name"><code>ehymet-01-introduction.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bpulidob/ehymet" class="external-link">ehymet</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="sec-goal">ehymet package goal<a class="anchor" aria-label="anchor" href="#sec-goal"></a>
</h2>
<p>The <strong>ehymet</strong> package
(<strong>E</strong>pigraph-<strong>Hy</strong>pograph based
<strong>met</strong>hodologies for functional data) is an <code>R</code>
package designed to extend popular multivariate data analysis
methodologies to functional data using various indices. The package
introduces the <strong>epigraph</strong> and <strong>hypograph</strong>
indices, along with their modified versions for functional datasets in
one or multiple dimensions. These indices transform a functional dataset
into a multivariate one, enabling the application of existing
multivariate data analysis methods.</p>
<p>More information about the theory behind these methodologies can
found in the following papers:</p>
<ul>
<li><p>Bel√©n Pulido, Alba M. Franco-Pereira, Rosa E. Lillo (2023). ‚ÄúA
fast epigraph and hypograph-based approach for clustering functional
data.‚Äù <em>Statistics and Computing</em>, <strong>33</strong>, 36. doi:
<a href="https://doi.org/10.1007/s11222-023-10213-7" class="external-link">10.1007/s11222-023-10213-7</a></p></li>
<li><p>Bel√©n Pulido, Alba M. Franco-Pereira, Rosa E. Lillo (2023). ‚ÄúThe
epigraph and the hypograph indices as useful tools for clustering
multivariate functional data.‚Äù doi: <a href="https://doi.org/10.48550/arXiv.2307.16720" class="external-link">10.48550/arXiv.2307.16720</a></p></li>
</ul>
</div>
<div class="section level2">
<h2 id="dgps-introduced-in-the-package">DGPs introduced in the package<a class="anchor" aria-label="anchor" href="#dgps-introduced-in-the-package"></a>
</h2>
<p><code>ehymet</code> introduces two functions which generate different
Data Generation Processes (DGPs) for functional data in one or multiple
dimension. The first function, <code>sim_model_ex1</code>, generate DGPs
in one dimension as originally described by <span class="citation">(Flores, Lillo, and Romo 2018)</span>. The second
function, <code>sim_model_ex2</code>, produces DGPs in both one and two
dimensions first introduced by <span class="citation">(Martino et al.
2019)</span>.</p>
<p>These functions are useful for simulating functional data to test
statistical methods or to understand the behavior of different models
under controlled conditions. Each of the two functions display different
DGPs depending on the given parameters, each of them with different
characteristics.</p>
<div class="section level3">
<h3 id="type-1-dgps">Type 1 DGPs<a class="anchor" aria-label="anchor" href="#type-1-dgps"></a>
</h3>
<p>The first set of DGPs is generated by function
<code>sim_model_ex1</code>, which produces eight different DGPs, each
corresponding to a different value of <code>i_sim</code>. Here‚Äôs a
breakdown of how each DGP is generated and how the function works:</p>
<div class="section level4">
<h4 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h4>
<ul>
<li>
<strong>n</strong>: The number of curves to generate <strong>for
each group</strong>. By default, this is set to 50 per group, resulting
in a total of 100 curves.</li>
<li>
<strong>p</strong>: The number of grid points at which the curves
are evaluated over the interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math>.
The default is 30 grid points.</li>
<li>
<strong>i_sim</strong>: An integer between 1 and 8 that specifies
which model to use for generating the curves in the second group. The
first group of curves is generated in the same way for all values of
<code>i_sim</code>.</li>
</ul>
</div>
<div class="section level4">
<h4 id="function-breakdown">Function breakdown<a class="anchor" aria-label="anchor" href="#function-breakdown"></a>
</h4>
<p>The first group of functions is generated by a Gaussian process
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>E</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">X_1(t)=E_1(t)+e(t),</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>30</mn><msup><mi>t</mi><mfrac><mn>3</mn><mn>2</mn></mfrac></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E_1(t)=30t^{ \frac{3}{2}}(1-t)</annotation></semantics></math>
is the mean function and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">e(t)</annotation></semantics></math>
is a centered Gaussian process with covariance matrix
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>o</mi><mi>v</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.3</mn><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚àí</mo><mfrac><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>t</mi><mi>i</mi></msub><mo>‚àí</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">|</mo></mrow><mn>0.3</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> Cov(e(t_i),e(t_j))=0.3 \exp\left(-\frac{\lvert t_i-t_j \rvert}{0.3}\right).</annotation></semantics></math></p>
<p>The second group of functions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>X</mi><mi>i</mi></msub><annotation encoding="application/x-tex">X_i</annotation></semantics></math>
are obtained from the first one by perturbing the generation process.
Different values of <code>i_sim</code> generate different curves.</p>
<p>For <code>i_sim</code> values of 1, 2, and 3, the curves in the
second group exhibit changes in the mean while the covariance matrix
remains unchanged. The changes in the mean increase in magnitude as
<code>i_sim</code> increases.</p>
<ul>
<li><p><strong>i_sim = 1</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>X</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.5</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">X_i(t)=X_1(t)+0.5.</annotation></semantics></math></p></li>
<li><p><strong>i_sim = 2</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>X</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.75</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">X_i(t)=X_1(t)+0.75.</annotation></semantics></math></p></li>
<li><p><strong>i_sim = 3</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>X</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>1</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">X_i(t)=X_1(t)+1.</annotation></semantics></math></p></li>
</ul>
<p>For <code>i_sim</code> 4 and 5, the curves in the second group are
obtained by multiplying the covariance matrix by a constant.</p>
<ul>
<li><p><strong>i_sim = 4</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>E</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>2</mn><mspace width="0.222em"></mspace><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">X_i(t)=E_1(t)+2 \ e(t).</annotation></semantics></math></p></li>
<li><p><strong>i_sim = 5</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>E</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.25</mn><mspace width="0.222em"></mspace><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">X_i(t)=E_1(t)+0.25 \ e(t).</annotation></semantics></math></p></li>
</ul>
<p>For <code>i_sim = 6</code>, the curves in the second group are
obtained by adding to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E_1(t)</annotation></semantics></math>
a centered Gaussian process
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h(t)</annotation></semantics></math>
whose covariance matrix is given by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mi>o</mi><mi>v</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.5</mn><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>‚àí</mo><mfrac><mrow><mo stretchy="false" form="prefix">|</mo><msub><mi>t</mi><mi>i</mi></msub><mo>‚àí</mo><msub><mi>t</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">|</mo></mrow><mn>0.2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> Cov(h(t_i),h(t_j))=0.5 \exp (-\frac{\lvert t_i-t_j\rvert}{0.2})</annotation></semantics></math>.</p>
<ul>
<li>
<strong>i_sim = 6</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>E</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mspace width="0.222em"></mspace><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">X_i(t)=E_1(t)+ \ h(t).</annotation></semantics></math>
</li>
</ul>
<p>For <code>i_sim</code> 7 and 8, the curves in the second group are
obtained by a different mean function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>30</mn><mi>t</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">E_2(t)=30t{(1-t)}^2</annotation></semantics></math>.</p>
<ul>
<li>
<strong>i_sim = 7</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>8</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>E</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">X_8(t)=E_2(t)+ h(t).</annotation></semantics></math>
</li>
<li>
<strong>i_sim = 8</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>9</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>E</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">X_9(t)=E_2(t)+ e(t).</annotation></semantics></math>
</li>
</ul>
</div>
<div class="section level4">
<h4 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h4>
<p>The function returns a data matrix of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>n</mi><mo>√ó</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">2n \times p</annotation></semantics></math>,
where the first
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
rows contain the curves from the first group, and the next
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
rows contain the curves from the second group, generated according to
the selected value of <code>i_sim</code>.</p>
</div>
<div class="section level4">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h4>
<p>To simulate the curves, we can follow these steps:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">curves</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_model_ex1.html">sim_model_ex1</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, i_sim <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">curves</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10 30</span></span></code></pre></div>
<p>This code generated 10 curves over the interval [0,1] with 30 grid
points, using <code>i_sim</code>=1</p>
<p>Also, we can plot them. To do so, we are going to load external
packages. This is just an example of how to plot the curves, but the end
user can do it the way they want.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nanx.me/ggsci/" class="external-link">ggsci</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_curves</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">curves</span>, <span class="va">title</span> <span class="op">=</span> <span class="st">""</span>, <span class="va">subtitle</span> <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">curves</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>curve_id <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">curves</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">/</span> <span class="fl">2</span></span>
<span></span>
<span>  <span class="va">data_long</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>      cols <span class="op">=</span> <span class="op">-</span><span class="va">curve_id</span>,</span>
<span>      names_to <span class="op">=</span> <span class="st">"point"</span>,</span>
<span>      values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      point <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"V"</span>, <span class="st">""</span>, <span class="va">point</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      group <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">curve_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">point</span>, y <span class="op">=</span> <span class="va">value</span>, group <span class="op">=</span> <span class="va">curve_id</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>      title    <span class="op">=</span> <span class="va">title</span>,</span>
<span>      subtitle <span class="op">=</span> <span class="va">subtitle</span>,</span>
<span>      color    <span class="op">=</span> <span class="st">"Group"</span>,</span>
<span>      x        <span class="op">=</span> <span class="st">""</span>,</span>
<span>      y        <span class="op">=</span> <span class="st">""</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_color_d3</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_half_open</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">plot_curves</span><span class="op">(</span><span class="va">curves</span>, title <span class="op">=</span> <span class="st">"Type 1 DGPs"</span>, subtitle <span class="op">=</span> <span class="st">"i_sim = 1"</span><span class="op">)</span></span></code></pre></div>
<p><img src="includes%2Fehymet-01-plot-sim-1-1-1.png"></p>
<p>The case for <code>i_sim = 7</code> has the following graph
representation:</p>
<p><img src="includes%2Fehymet-01-plot-sim-1-7-1.png"></p>
<p>Clear differences can be seen between both plots. We leave it up to
the end user to experiment as they see fit with the simulations.</p>
</div>
</div>
<div class="section level3">
<h3 id="type-2-dgps">Type 2 DGPs<a class="anchor" aria-label="anchor" href="#type-2-dgps"></a>
</h3>
<p>The second set of DGPs is generated by function
<code>sim_model_ex2</code>, which produces four different DGPs, each
corresponding to a different value of <strong>i_sim</strong>. The first
two DGPs are in one dimension, while the remaining two DGPs are
two-dimensions functional datasets. Here‚Äôs a breakdown of how each DGP
is generated and how the function works:</p>
<div class="section level4">
<h4 id="parameters-1">Parameters<a class="anchor" aria-label="anchor" href="#parameters-1"></a>
</h4>
<ul>
<li>
<strong>n</strong>: The number of curves to generate <strong>for
each group</strong>. By default, this is set to 50 per group, resulting
in a total of 100 curves.</li>
<li>
<strong>p</strong>: The number of grid points at which the curves
are evaluated over the interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow><annotation encoding="application/x-tex">[0, 1]</annotation></semantics></math>.
The default is 150 grid points.</li>
<li>
<strong>i_sim</strong>: An integer between 1 and 4. 1 and 2 for
one-dimensional functional data and 3 and 4 for the multidimensional
case.</li>
</ul>
</div>
<div class="section level4">
<h4 id="function-breakdown-1">Function breakdown<a class="anchor" aria-label="anchor" href="#function-breakdown-1"></a>
</h4>
<p>For the <strong>one-dimensional case</strong> the first group of
functions is generated by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>E</mi><mn>3</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>A</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">X_{1}(t)=E_3(t)+ A(t),</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mn>3</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E_3(t)=t(1-t)</annotation></semantics></math>
is the mean function, and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mn>100</mn></munderover><msub><mi>Z</mi><mi>k</mi></msub><msqrt><msub><mi>œÅ</mi><mi>k</mi></msub></msqrt><msub><mi>Œ∏</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">A(t) =  \sum_{k=1}^{100} Z_k\sqrt{\rho_k}\theta_k(t),</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>Z</mi><mi>k</mi></msub><mo>,</mo><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mn>100</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{Z_k, k=1,...,100\}</annotation></semantics></math>
being independent standard normal variables, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>œÅ</mi><mi>k</mi></msub><mo>,</mo><mi>k</mi><mo>‚â•</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{ \rho_k,k\geq 1 \}</annotation></semantics></math>
a positive real numbers sequence defined as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>œÅ</mi><mi>k</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mfrac><mn>1</mn><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mi>i</mi><mi>f</mi></mtd><mtd columnalign="left" style="text-align: left"><mi>k</mi><mo>‚àà</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn><mo stretchy="false" form="postfix">}</mo><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mfrac><mn>1</mn><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mi>i</mi><mi>f</mi></mtd><mtd columnalign="left" style="text-align: left"><mi>k</mi><mo>‚â•</mo><mn>4</mn><mo>,</mo></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\rho_k = \left\{
           \begin{array}{lll}
         \frac{1}{k+1}      &amp; if &amp; k \in \{1,2,3\}, \\
         \frac{1}{{(k+1)}^2} &amp; if &amp; k \geq 4,
           \end{array}
         \right. </annotation></semantics></math> in such a way that the
values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œÅ</mi><mi>k</mi></msub><annotation encoding="application/x-tex">\rho_k</annotation></semantics></math>
are chosen to decrease faster when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>‚â•</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">k\geq 4</annotation></semantics></math>
in order to have most of the variance explained by the first three
principal components. The sequence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>Œ∏</mi><mi>k</mi></msub><mo>,</mo><mi>k</mi><mo>‚â•</mo><mn>1</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{\theta_k, k\geq 1\}</annotation></semantics></math>
is an orthonormal basis of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>I</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">L^2(I)</annotation></semantics></math>
defined as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œ∏</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>I</mi><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mi>i</mi><mi>f</mi></mtd><mtd columnalign="left" style="text-align: left"><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo></mtd><mtd columnalign="left" style="text-align: left"></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msqrt><mn>2</mn></msqrt><mo>sin</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mi>œÄ</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>I</mi><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mi>i</mi><mi>f</mi></mtd><mtd columnalign="left" style="text-align: left"><mi>k</mi><mo>‚â•</mo><mn>2</mn><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"></mtd><mtd columnalign="left" style="text-align: left"></mtd><mtd columnalign="left" style="text-align: left"><mi>k</mi><mspace width="0.222em"></mspace><mi>e</mi><mi>v</mi><mi>e</mi><mi>n</mi><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msqrt><mn>2</mn></msqrt><mo>cos</mo><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>œÄ</mi><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>I</mi><mrow><mo stretchy="true" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">]</mo></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mi>i</mi><mi>f</mi></mtd><mtd columnalign="left" style="text-align: left"><mi>k</mi><mo>‚â•</mo><mn>3</mn><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"></mtd><mtd columnalign="left" style="text-align: left"></mtd><mtd columnalign="left" style="text-align: left"><mi>k</mi><mspace width="0.222em"></mspace><mi>o</mi><mi>d</mi><mi>d</mi><mo>,</mo></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\theta_k(t) = \left\{
           \begin{array}{lllll}
         I_{[0,1]}(t)    &amp; if &amp; k=1, &amp;  \\
         \sqrt{2}\sin{(k\pi t)}I_{[0,1]}(t) &amp; if &amp; k \geq 2,\\ &amp; &amp; k \ even,\\
         \sqrt{2}\cos{((k-1)\pi t)}I_{[0,1]}(t)  &amp; if &amp; k \geq 3,\\ &amp; &amp; k \ odd,
           \end{array}
         \right. </annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>A</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">I_A(t)</annotation></semantics></math>
stands for the indicator function of set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>A</mi><annotation encoding="application/x-tex">A</annotation></semantics></math>.</p>
<p>The second group of data is generated as follows, depending on the
value of <code>i_sim</code>:</p>
<ul>
<li><p><strong>i_sim = 1</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>E</mi><mn>4</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>A</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">X_{i}(t)=E_4(t)+ A(t),</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mn>4</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>E</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mo>‚àë</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mn>3</mn></msubsup><msqrt><msub><mi>œÅ</mi><mi>k</mi></msub></msqrt><msub><mi>Œ∏</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">E_4(t)=E_2(t)+\displaystyle \sum_{k=1}^3\sqrt{\rho_k}\theta_k(t).</annotation></semantics></math></p></li>
<li><p><strong>i_sim = 2</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>E</mi><mn>5</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>A</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">X_{i}(t)=E_5(t)+ A(t),</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mn>5</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>E</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msubsup><mo>‚àë</mo><mrow><mi>k</mi><mo>=</mo><mn>4</mn></mrow><mn>100</mn></msubsup><msqrt><msub><mi>œÅ</mi><mi>k</mi></msub></msqrt><msub><mi>Œ∏</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">E_5(t)=E_2(t)+\displaystyle \sum_{k=4}^{100}\sqrt{\rho_k}\theta_k(t).</annotation></semantics></math></p></li>
</ul>
<p>For the <strong>two-dimensional case</strong> the first group of
functions is generated by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùêó</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>ùêÑ</mi><mn>6</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathbf{X}_{1}(t)=\mathbf{E}_6(t)+ B(t),</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùêÑ</mi><mn>6</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>4</mn><msup><mi>t</mi><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{E}_6(t)=
\begin{pmatrix}
    t(1-t)\\
    4t^2(1-t)
\end{pmatrix}</annotation></semantics></math> is the mean function of
this process, and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùêÅ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>‚àë</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mn>100</mn></munderover><msub><mi>ùêô</mi><mi>k</mi></msub><msqrt><msub><mi>œÅ</mi><mi>k</mi></msub></msqrt><msub><mi>Œ∏</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathbf{B}(t) = \sum_{k=1}^{100} \mathbf{Z}_k\sqrt{\rho_k}\theta_k(t),</annotation></semantics></math>
where
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùêÑ</mi><mn>6</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>4</mn><msup><mi>t</mi><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{E}_6(t)=
\begin{pmatrix}
    t(1-t)\\
    4t^2(1-t)
\end{pmatrix}</annotation></semantics></math> is the mean function of
this process,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><msub><mi>ùêô</mi><mi>k</mi></msub><mo>,</mo><mi>k</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mn>100</mn><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{\mathbf{Z}_k, k=1,...,100\}</annotation></semantics></math>
are independent bivariate normal random variables, with mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùõç</mi><mo mathvariant="bold">=</mo><mn>ùüé</mn></mrow><annotation encoding="application/x-tex">\mathbf{\mu = 0}</annotation></semantics></math>
and covariance matrix
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ£</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>0.5</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mn>0.5</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>1</mn></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\Sigma=
 \begin{pmatrix}
    1 &amp; 0.5\\
    0.5 &amp; 1
\end{pmatrix}.</annotation></semantics></math> The second group of data
is generated as follows, depending on the value of
<code>i_sim</code>:</p>
<ul>
<li><p><strong>i_sim = 3</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>ùêÑ</mi><mn>7</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">X_{i}(t)=\mathbf{E}_7(t)+ B(t),</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùêÑ</mi><mn>7</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>ùêÑ</mi><mn>6</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>ùüè</mn><msubsup><mo>‚àë</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mn>3</mn></msubsup><msqrt><msub><mi>œÅ</mi><mi>k</mi></msub></msqrt><msub><mi>Œ∏</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathbf{E}_7(t)=\mathbf{E}_6(t)+\mathbf{1}\displaystyle \sum_{k=1}^3\sqrt{\rho_k}\theta_k(t),</annotation></semantics></math>
is the mean function of this process, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>ùüè</mn><annotation encoding="application/x-tex">\mathbf{1}</annotation></semantics></math>
represents a vector of 1s.</p></li>
<li><p><strong>i_sim = 4</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>ùêÑ</mi><mn>8</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">X_{i}(t)=\mathbf{E}_8(t)+ B(t),</annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùêÑ</mi><mn>8</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>ùêÑ</mi><mn>6</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>ùüè</mn><msubsup><mo>‚àë</mo><mrow><mi>k</mi><mo>=</mo><mn>4</mn></mrow><mn>100</mn></msubsup><msqrt><msub><mi>œÅ</mi><mi>k</mi></msub></msqrt><msub><mi>Œ∏</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\mathbf{E}_8(t)=\mathbf{E}_6(t)+\mathbf{1}\displaystyle \sum_{k=4}^{100}\sqrt{\rho_k}\theta_k(t).</annotation></semantics></math></p></li>
</ul>
</div>
<div class="section level4">
<h4 id="output-1">Output<a class="anchor" aria-label="anchor" href="#output-1"></a>
</h4>
<p>The function returns for the <strong>one-dimensional case</strong>
(<code>i_sim=1,2</code>) a data matrix of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>n</mi><mo>√ó</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">2n \times p</annotation></semantics></math>.
The output for the <strong>two-dimensional case</strong>
(<code>i_sim=3,4</code>)is an array of dimensions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>n</mi><mo>√ó</mo><mi>p</mi><mo>√ó</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2n \times p \times 2</annotation></semantics></math>.</p>
</div>
<div class="section level4">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a>
</h4>
<p>This function generates functional curves in one dimension for values
of <code>i_sim</code> equal to 1 and 2, and functional datasets in two
dimensions for values of <code>i_sim</code> equal to 3 and 4. Here, we
would like to point out how to simulate a multivariate functional
dataset with <code>i_sim = 3</code> or <code>i_sim = 4</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">curves</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_model_ex2.html">sim_model_ex2</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, i_sim <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">curves</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  10 150   2</span></span></code></pre></div>
<p>As can be seen, now we don‚Äôt have a matrix but a 3-dimensional array.
We are going to plot the first dimension:</p>
<p><img src="includes%2Fehymet-01-plot-sim-2-3-1dimension-1.png"></p>
<p>And now the second dimension:</p>
<p><img src="includes%2Fehymet-01-plot-sim-2-3-2dimension-1.png"></p>
<p>For the sake of visualization, we can also obtain the derivatives of
the curves using the <code>funspline</code> function, which is an
internal function of the <code>ehymet</code> package. It can be used
with <code>ehymet:::</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">funspline_result</span> <span class="op">&lt;-</span> <span class="fu">ehymet</span><span class="fu">:::</span><span class="fu">funspline</span><span class="op">(</span><span class="va">curves</span><span class="op">)</span></span>
<span><span class="va">deriv</span> <span class="op">&lt;-</span> <span class="va">funspline_result</span><span class="op">$</span><span class="va">deriv</span></span>
<span><span class="va">deriv2</span> <span class="op">&lt;-</span> <span class="va">funspline_result</span><span class="op">$</span><span class="va">deriv2</span></span></code></pre></div>
<p>The plot for first dimension of the derivative is the following
one:</p>
<p><img src="includes%2Fehymet-01-plot-sim-2-3-1dimension-deriv-1.png"></p>
<p>And for the second dimensions:</p>
<p><img src="includes%2Fehymet-01-plot-sim-2-3-2dimension-deriv-1.png"></p>
<p>We can observe a clear overlapping between first derivatives curves
on both dimensions.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="indices-computation">Indices computation<a class="anchor" aria-label="anchor" href="#indices-computation"></a>
</h2>
<p><code>ehymet</code> provides the implementation of the epigraph and
the hypograph index, both in one and multiple dimensions. The function
to generate the indices is <code>generate_indices</code> and it can
compute:</p>
<ul>
<li>
<strong>Epigraph Index</strong> (EI)</li>
<li>
<strong>Hypograph Index</strong> (HI)</li>
<li>
<strong>Modified Epigraph Index</strong> (MEI)</li>
<li>
<strong>Modified Hypograph Index</strong> (MHI)</li>
</ul>
<p>The <code>indices</code> parameter can be specified to calculate a
subset of the total indices, but by default it calculates all of them.
Indices for one-dimensional functional data or for data in more
dimensions are calculated depending of the size of the input array.</p>
<p>Let‚Äôs try this function to generate indices with multidimensional
data generated with <code>sim_model_ex2</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">curves</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_model_ex2.html">sim_model_ex2</a></span><span class="op">(</span>i_sim <span class="op">=</span> <span class="fl">4</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">curves</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 100 150   2</span></span></code></pre></div>
<p>And now compute the indices for the multidimensional data:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indices_mult</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_indices.html">generate_indices</a></span><span class="op">(</span><span class="va">curves</span><span class="op">)</span></span></code></pre></div>
<p>We can check that all the indices are computed for each curve and for
its first and second derivative:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">indices_mult</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "dtaEI"    "ddtaEI"   "d2dtaEI"  "dtaHI"    "ddtaHI"   "d2dtaHI" </span></span>
<span><span class="co">#&gt;  [7] "dtaMEI"   "ddtaMEI"  "d2dtaMEI" "dtaMHI"   "ddtaMHI"  "d2dtaMHI"</span></span></code></pre></div>
<p>We can also take a quick look to the generated indices:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">indices_mult</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   dtaEI ddtaEI d2dtaEI dtaHI ddtaHI d2dtaHI dtaMEI   ddtaMEI</span></span>
<span><span class="co">#&gt; 1  0.99   0.99    0.99  0.01   0.01    0.01 0.8068 0.7372667</span></span>
<span><span class="co">#&gt; 2  0.99   0.99    0.99  0.01   0.01    0.01 0.7458 0.7348667</span></span>
<span><span class="co">#&gt; 3  0.98   0.99    0.99  0.01   0.01    0.01 0.5360 0.7300000</span></span>
<span><span class="co">#&gt;    d2dtaMEI    dtaMHI   ddtaMHI  d2dtaMHI</span></span>
<span><span class="co">#&gt; 1 0.6912667 0.2582667 0.3046000 0.2504667</span></span>
<span><span class="co">#&gt; 2 0.6760667 0.2315333 0.2957333 0.2698667</span></span>
<span><span class="co">#&gt; 3 0.6956000 0.1463333 0.2895333 0.2426000</span></span></code></pre></div>
<p>Now, for the sake of comparison, let‚Äôs see what happens if we
calculate the indices separately for each dimension and check the first
few rows:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indices_dim1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_indices.html">generate_indices</a></span><span class="op">(</span><span class="va">curves</span><span class="op">[</span>, , <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">indices_dim2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_indices.html">generate_indices</a></span><span class="op">(</span><span class="va">curves</span><span class="op">[</span>, , <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">indices_dim1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   dtaEI ddtaEI d2dtaEI dtaHI ddtaHI d2dtaHI    dtaMEI   ddtaMEI</span></span>
<span><span class="co">#&gt; 1  0.94   0.99    0.99  0.03   0.01    0.01 0.4260000 0.5051333</span></span>
<span><span class="co">#&gt; 2  0.91   0.99    0.99  0.01   0.01    0.01 0.3576667 0.5132667</span></span>
<span><span class="co">#&gt; 3  0.95   0.99    0.99  0.01   0.01    0.01 0.3458000 0.5030667</span></span>
<span><span class="co">#&gt;    d2dtaMEI    dtaMHI   ddtaMHI  d2dtaMHI</span></span>
<span><span class="co">#&gt; 1 0.4685333 0.4360000 0.5151333 0.4785333</span></span>
<span><span class="co">#&gt; 2 0.4755333 0.3676667 0.5232667 0.4855333</span></span>
<span><span class="co">#&gt; 3 0.4674667 0.3558000 0.5130667 0.4774667</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">indices_dim2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   dtaEI ddtaEI d2dtaEI dtaHI ddtaHI d2dtaHI    dtaMEI   ddtaMEI</span></span>
<span><span class="co">#&gt; 1  0.99   0.99    0.99  0.04   0.01    0.01 0.6290667 0.5267333</span></span>
<span><span class="co">#&gt; 2  0.99   0.99    0.99  0.01   0.01    0.01 0.6096667 0.5073333</span></span>
<span><span class="co">#&gt; 3  0.95   0.99    0.99  0.01   0.01    0.01 0.3265333 0.5064667</span></span>
<span><span class="co">#&gt;    d2dtaMEI    dtaMHI   ddtaMHI  d2dtaMHI</span></span>
<span><span class="co">#&gt; 1 0.4632000 0.6390667 0.5367333 0.4732000</span></span>
<span><span class="co">#&gt; 2 0.4604000 0.6196667 0.5173333 0.4704000</span></span>
<span><span class="co">#&gt; 3 0.4607333 0.3365333 0.5164667 0.4707333</span></span></code></pre></div>
<p>One difference that is readily apparent is, for example, for
‚ÄúdtaMHI‚Äù. Let‚Äôs take a look at it:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  dim1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">indices_dim1</span><span class="op">[</span><span class="st">"dtaMHI"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  dim2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">indices_dim2</span><span class="op">[</span><span class="st">"dtaMHI"</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">indices_mult</span><span class="op">[</span><span class="st">"dtaMHI"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;        dim1      dim2      mult</span></span>
<span><span class="co">#&gt; 1 0.4360000 0.6390667 0.2582667</span></span>
<span><span class="co">#&gt; 2 0.3676667 0.6196667 0.2315333</span></span>
<span><span class="co">#&gt; 3 0.3558000 0.3365333 0.1463333</span></span>
<span><span class="co">#&gt; 4 0.3744000 0.7898000 0.3180000</span></span>
<span><span class="co">#&gt; 5 0.3574000 0.5160000 0.1821333</span></span></code></pre></div>
<p>Let‚Äôs plot MHI vs MEI for both the original curves and both first and
second derivatives:</p>
<p><img src="includes%2Fehymet-01-plot-MHIvsMEI-original-curves-1.png"></p>
<p><img src="includes%2Fehymet-01-plot-MHIvsMEI-first-derivatives-1.png"></p>
<p><img src="includes%2Fehymet-01-plot-MHIvsMEI-second-derivatives-1.png"></p>
<p>For the original curves, no clear separation is evidenced. However,
both in the first and second derivatives we see that the groups are
clearly differentiated. This may indicate that using the MEI and MHI
indices computed for the first or second derivatives could yield great
results in clustering problems.</p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-flores_homogeneity_2018" class="csl-entry">
Flores, Ram√≥n, Rosa Lillo, and Juan Romo. 2018. <span>‚ÄúHomogeneity Test
for Functional Data.‚Äù</span> <em>Journal of Applied Statistics</em> 45
(5): 868‚Äì83. <a href="https://doi.org/10.1080/02664763.2017.1319470" class="external-link">https://doi.org/10.1080/02664763.2017.1319470</a>.
</div>
<div id="ref-martino_k-means_2019" class="csl-entry">
Martino, Andrea, Andrea Ghiglietti, Francesca Ieva, and Anna Maria
Paganoni. 2019. <span>‚ÄúA k-Means Procedure Based on a
<span>Mahalanobis</span> Type Distance for Clustering Multivariate
Functional Data.‚Äù</span> <em>Stat Methods Appl</em> 28 (2): 301‚Äì22. <a href="https://doi.org/10.1007/s10260-018-00446-6" class="external-link">https://doi.org/10.1007/s10260-018-00446-6</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Belen Pulido.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
